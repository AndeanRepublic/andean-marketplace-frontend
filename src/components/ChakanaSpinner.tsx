"use client";
import { useEffect, useRef } from "react";
import gsap from "gsap";

type Props = { size?: number; color?: string; duration?: number };

export default function ChakanaSpinner({
  size = 200,
  color = "#FFFFFF",
  duration = 5,
}: Props) {
  const svgRef = useRef<SVGSVGElement>(null);

  useEffect(() => {
    const ctx = gsap.context(() => {
      gsap.to(svgRef.current, {
        rotate: 360,
        duration,
        repeat: -1,
        ease: "linear",
        transformOrigin: "50% 50%",
      });
    }, svgRef);
    return () => ctx.revert();
  }, [duration]);

  return (
    <svg
      ref={svgRef}
      viewBox="0 0 473 474"
      // 👇 asegura tamaño exacto y que no “salte”
      width={size}
      height={size}
      style={{ display: "block" }}
      xmlns="http://www.w3.org/2000/svg"
      aria-label="Chakana spinner"
    >
      <path
        d="M47.2789 177.655H12.1852C5.55776 177.655 0.185181 183.028 0.185181 189.655V283.843C0.185181 290.47 5.55775 295.843 12.1852 295.843H47.2789C53.9063 295.843 59.2789 301.215 59.2789 307.843V342.936C59.2789 349.564 64.6514 354.936 71.2789 354.936H106.373C113 354.936 118.373 360.309 118.373 366.936V402.03C118.373 408.658 123.745 414.03 130.373 414.03H165.466C172.094 414.03 177.466 419.403 177.466 426.03V461.124C177.466 467.751 182.839 473.124 189.466 473.124H283.654C290.281 473.124 295.654 467.751 295.654 461.124V426.03C295.654 419.403 301.026 414.03 307.654 414.03H342.747C349.375 414.03 354.747 408.658 354.747 402.03V366.936C354.747 360.309 360.12 354.936 366.747 354.936H401.841C408.468 354.936 413.841 349.564 413.841 342.936V307.843C413.841 301.215 419.214 295.843 425.841 295.843H460.935C467.562 295.843 472.935 290.47 472.935 283.843V189.655C472.935 183.028 467.562 177.655 460.935 177.655H425.841C419.214 177.655 413.841 172.283 413.841 165.655V130.562C413.841 123.934 408.468 118.562 401.841 118.562H366.747C360.12 118.562 354.747 113.189 354.747 106.562V71.468C354.747 64.8406 349.375 59.468 342.747 59.468H307.654C301.026 59.468 295.654 54.0954 295.654 47.468V12.3743C295.654 5.74688 290.281 0.374298 283.654 0.374298H189.466C182.839 0.374298 177.466 5.74687 177.466 12.3743V47.468C177.466 54.0954 172.094 59.468 165.466 59.468H130.373C123.745 59.468 118.373 64.8406 118.373 71.468V106.562C118.373 113.189 113 118.562 106.373 118.562H71.2789C64.6515 118.562 59.2789 123.934 59.2789 130.562V165.655C59.2789 172.283 53.9063 177.655 47.2789 177.655Z"
        fill={color}
      />
    </svg>
  );
}
